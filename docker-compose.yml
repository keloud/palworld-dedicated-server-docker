services:
  game:
    build: ./bullseye
    container_name: palworld-dedicated
    restart: unless-stopped
    stop_grace_period: 30s
    volumes:
      - gamedata:/home/steam/palworld-dedicated
      - backupdata:/home/steam/palworld-dedicated-backup
    ports:
      - "127.0.0.1:8211:8211/udp"
      - "127.0.0.1:27015:27015/udp"
      - "[::1]:8211:8211/udp"
      - "[::1]:27015:27015/udp"
    expose:
      - "25575/tcp"
    environment:
      - MAXPLAYERS=10
      - SERVER_PASSWORD_FILE=/run/secrets/server_password
      - ADMIN_PASSWORD_FILE=/run/secrets/admin_password
      - SERVER_NAME="Palworld Dedicated Server"
      - SERVER_DESCRIPTION="Dedicated Server"

secrets:
  server_password:
    file: ./server_password.txt
  admin_password:
    file: ./admin_password.txt

volumes:
  gamedata:
  backupdata:
